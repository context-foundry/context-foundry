import { fetchWeatherData, formatWeatherData } from '../api.js';

// Mocking fetch
global.fetch = jest.fn(() =>
    Promise.resolve({
        ok: true,
        json: () => Promise.resolve({
            name: 'London',
            main: { temp: 15 },
            weather: [{ description: 'clear sky', icon: '01d' }],
        }),
    })
);

describe('API Functionality', () => {
    it('fetchWeatherData should return valid weather data', async () => {
        const data = await fetchWeatherData('London');
        expect(data.name).toBe('London');
        expect(data.main.temp).toBe(15);
    });

    it('formatWeatherData should format the API data correctly', () => {
        const data = {
            name: 'London',
            main: { temp: 15 },
            weather: [{ description: 'clear sky', icon: '01d' }],
        };
        const formattedData = formatWeatherData(data);
        expect(formattedData).toEqual({
            city: 'London',
            temperature: 15,
            description: 'clear sky',
            icon: 'http://openweathermap.org/img/wn/01d.png',
        });
    });
});