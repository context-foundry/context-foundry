import { fetchWeatherData, formatWeatherData } from './api.js';

// HTML elements
const weatherForm = document.getElementById('weather-form');
const cityInput = document.getElementById('city-input');
const weatherDisplay = document.getElementById('weather-display');

/**
 * Handle the form submission to fetch weather data.
 * @param {Event} event - The form submission event.
 */
async function handleWeatherFormSubmit(event) {
    event.preventDefault();
    
    const city = cityInput.value.trim();
    
    if (!city) {
        alert('Please enter a city name');
        return;
    }

    try {
        const rawWeatherData = await fetchWeatherData(city);
        const weatherData = formatWeatherData(rawWeatherData);
        displayWeather(weatherData);
    } catch (error) {
        alert('Could not retrieve weather data. Please try again later.');
    }
}

/**
 * Display the weather data on the webpage.
 * @param {Object} weatherData - The formatted weather data to display.
 */
function displayWeather(weatherData) {
    weatherDisplay.innerHTML = `
        <h2>Weather in ${weatherData.city}</h2>
        <p>Temperature: ${weatherData.temperature} Â°C</p>
        <p>Description: ${weatherData.description}</p>
        <img src="${weatherData.icon}" alt="Weather icon">
    `;
}

// Event listener for the form submission
weatherForm.addEventListener('submit', handleWeatherFormSubmit);